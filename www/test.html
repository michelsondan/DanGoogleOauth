<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script>
        function driveloaded() {
            gapi.auth.setToken({
                access_token: 'ya29.Ci-RAxmeXUTmTbuvruLEdug7NOLQrzMi4YkD0D4qf3aJ5qiaFMI9U-1HbKV-f2rOOg'
            });

            gapi.client.load('drive', 'v2', onDriveClientLoaded);
        }

        function onDriveClientLoaded() {
            var request = gapi.client.drive.files.list({
                'q': '"0BxOZ7Vr1rW6NWlFibXNhM0dZRW8" in parents'
            });

            request.execute(function (resp) {
                var files = resp.items;
                if (files && files.length > 0) {
                    for (var i = 0; i < files.length; i++) {
                        var file = files[i];
                        alert(file.title + ' (' + file.id + ')');
                        var dload = file.downloadUrl;

                        if (i == 0) {
                            //////////////////////////////
                            var req2 = gapi.client.drive.permissions.list({ 'fileId': file.id });
                            req2.execute(function (res2) {
                                var rdr = false;
                                for (var t = 0; t < res2.result.items.length; t++) {
                                    if (res2.result.items[t].role == 'reader') {
                                        rdr = true;
                                        break;
                                    }
                                }
                                if (!rdr) {
                                    var req3 = gapi.client.drive.permissions.insert({ 'fileId': file.id, resource: { 'withLink': true, 'type': 'anyone', 'role': 'reader', 'value': '' } });
                                    req3.execute(function (res3) {
                                        alert(res3);
                                    });
                                }
                            });


                            //////////////////////////////
                        }
                    }
                } else {
                    alert('No files found.');
                }
            });
        }
    </script>
    <script type="text/javascript" src="js/jquery-1.10.1.min.js"></script>
    <script src="https://apis.google.com/js/client.js?onload=driveloaded"></script>
</head>
<body>
    <audio controls>
        <source src="https://drive.google.com/uc?export=download&id=0B5cPqh4mvftUdEJwemk5cjZDMG8" type="audio/ogg">
        <source src="https://drive.google.com/uc?export=download&id=0B5cPqh4mvftUdEJwemk5cjZDMG8" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
</body>
</html>
